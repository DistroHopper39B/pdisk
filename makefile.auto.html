<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>makefile</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">makefile&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="makefile">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">#
</span><span class="enscript-comment"># Makefile for pdisk
</span><span class="enscript-comment">#
</span>
MAN_PAGE= \
	pdisk.8

MAC_DOC= \
	pdisk.html

DOCS= \
	HISTORY \
	README \
	$(<span class="enscript-reference">MAN_PAGE</span>) \
	$(<span class="enscript-reference">MAC_DOC</span>)

SERVER_README = \
	dist.README

SERVER_MESSAGE = \
	dist.message

DOCS_INTERNAL= \
	HISTORY.ALL \
	HOWTO.DISTRIBUTE \
	To_do_list \
	command-language

SUPPORT= \
	make_filename \
	make_depend \
	make_tags \
	checkin_files \
	MPWcompare \
	name_latest \
	next_release

MAC_SOURCE= \
	ATA_media.c \
	ATA_media.h \
	DoSCSICommand.c \
	DoSCSICommand.h \
	MacSCSICommand.h \
	SCSI_media.c \
	SCSI_media.h \
	pdisk.r

UNIX_SOURCE= \
	bitfield.c \
	bitfield.h \
	convert.c \
	convert.h \
	cvt_pt.c \
	deblock_media.c \
	deblock_media.h \
	dpme.h \
	dump.c \
	dump.h \
	errors.c \
	errors.h \
	file_media.c \
	file_media.h \
	hfs_misc.c \
	hfs_misc.h \
	io.c \
	io.h \
	layout_dump.c \
	layout_dump.h \
	makefile \
	media.c \
	media.h \
	partition_map.c \
	partition_map.h \
	pathname.c \
	pathname.h \
	pdisk.c \
	pdisk.h \
	util.c \
	util.h \
	validate.c \
	validate.h \
	version.h

COMMON_OBJECTS = \
	partition_map.o \
	bitfield.o \
	convert.o \
	deblock_media.o \
	file_media.o \
	errors.o \
	hfs_misc.o \
	io.o \
	media.o \
	pathname.o \
	util.o

UNIX_OBJECTS = \
	pdisk.o \
	dump.o \
	$(<span class="enscript-reference">COMMON_OBJECTS</span>) \
	validate.o

CVT_OBJECTS = \
	cvt_pt.o \
	$(<span class="enscript-reference">COMMON_OBJECTS</span>)



ALL_FILES= $(<span class="enscript-reference">DOCS</span>) $(<span class="enscript-reference">DOCS_INTERNAL</span>) $(<span class="enscript-reference">SUPPORT</span>) $(<span class="enscript-reference">MAC_SOURCE</span>) $(<span class="enscript-reference">UNIX_SOURCE</span>)

UNIX_BINARIES= \
	pdisk \
	cvt_pt

<span class="enscript-comment">#
</span><span class="enscript-comment"># these names have '__' in place of ' ' to avoid quoting nightmares 
</span><span class="enscript-comment">#
</span>MAC_PROJECT= \
	pdisk.mac.bin \
	pdisk.mac__Data/CW__Settings.stm.bin \
	pdisk.mac__Data/pdisk.tdm.bin \
	pdisk.mac__Data/pdisk__68k.tdm.bin

<span class="enscript-comment"># Constructed under MacOS using CodeWarrior from MAC_PROJECT &amp; sources
</span>MAC_BINARY= \
	pdisk.hqx

MAC_68KBINARY= \
	pdisk_68k.hqx


CFLAGS = -Wall -D__unix__
DIST_TAR_FLAGS = cvf


<span class="enscript-keyword">all:</span> $(<span class="enscript-reference">UNIX_BINARIES</span>)

<span class="enscript-keyword">pdisk:</span> $(<span class="enscript-reference">UNIX_OBJECTS</span>)
	cc -o pdisk $(<span class="enscript-reference">UNIX_OBJECTS</span>)

<span class="enscript-keyword">cvt_pt:</span> $(<span class="enscript-reference">CVT_OBJECTS</span>)
	cc -o cvt_pt $(<span class="enscript-reference">CVT_OBJECTS</span>)

<span class="enscript-keyword">tags:</span>	$(<span class="enscript-reference">MAC_SOURCE</span>) $(<span class="enscript-reference">UNIX_SOURCE</span>)
	ctags $(<span class="enscript-reference">MAC_SOURCE</span>) $(<span class="enscript-reference">UNIX_SOURCE</span>)

<span class="enscript-keyword">clean:</span>
	rm -f *.o $(<span class="enscript-reference">UNIX_BINARIES</span>) list.src

<span class="enscript-keyword">clobber:</span>	clean
	rm -f $(<span class="enscript-reference">ALL_FILES</span>) $(<span class="enscript-reference">MAC_BINARY</span>) $(<span class="enscript-reference">MAC_68KBINARY</span>) tags

<span class="enscript-comment"># note the sed to reinsert the spaces in the Mac names
</span><span class="enscript-keyword">list.src:</span> $(<span class="enscript-reference">MAC_SOURCE</span>) $(<span class="enscript-reference">DOCS</span>) $(<span class="enscript-reference">UNIX_SOURCE</span>) $(<span class="enscript-reference">MAC_PROJECT</span>)
	echo $(<span class="enscript-reference">MAC_SOURCE</span>) $(<span class="enscript-reference">DOCS</span>) $(<span class="enscript-reference">UNIX_SOURCE</span>) $(<span class="enscript-reference">MAC_PROJECT</span>) |\
	tr ' ' '\n' | sed -e 's/__/ /g' -e 's,^,pdisk/,' &gt;list.src

<span class="enscript-comment">#
</span><span class="enscript-comment"># this depends on this source directory being named 'pdisk'
</span><span class="enscript-comment">#
</span><span class="enscript-keyword">distribution:</span> list.src
	cd ..; tar $(<span class="enscript-reference">DIST_TAR_FLAGS</span>) pdisk/dist/pdisk.src.tar.<span class="enscript-string">`date +%Y%m%d`</span> --files-from pdisk/list.src
	tar $(<span class="enscript-reference">DIST_TAR_FLAGS</span>) dist/pdisk.bin.tar.<span class="enscript-string">`date +%Y%m%d`</span> $(<span class="enscript-reference">UNIX_BINARIES</span>) $(<span class="enscript-reference">MAN_PAGE</span>)
	cp -f $(<span class="enscript-reference">MAC_DOC</span>) dist/$(<span class="enscript-reference">MAC_DOC</span>).<span class="enscript-string">`date +%Y%m%d`</span>
	cp -f $(<span class="enscript-reference">MAC_BINARY</span>) dist/$(<span class="enscript-reference">MAC_BINARY</span>).<span class="enscript-string">`date +%Y%m%d`</span>
	cp -f $(<span class="enscript-reference">MAC_68KBINARY</span>) dist/$(<span class="enscript-reference">MAC_68KBINARY</span>).<span class="enscript-string">`date +%Y%m%d`</span>

<span class="enscript-keyword">checkin:</span>
	./checkin_files $(<span class="enscript-reference">ALL_FILES</span>)

<span class="enscript-keyword">checkout:</span>	$(<span class="enscript-reference">ALL_FILES</span>)

<span class="enscript-keyword">diff:</span>
	rcsdiff $(<span class="enscript-reference">ALL_FILES</span>) 2&gt;&amp;1

<span class="enscript-keyword">name:</span>
	./name_latest $(<span class="enscript-reference">ALL_FILES</span>)

<span class="enscript-comment">#
</span><span class="enscript-comment"># in lieu of a real dependency generator
</span><span class="enscript-comment">#
</span><span class="enscript-keyword">convert.h:</span>	dpme.h
<span class="enscript-keyword">deblock_media.h:</span>	media.h
<span class="enscript-keyword">dpme.h:</span>	bitfield.h
<span class="enscript-keyword">dump.h:</span>	partition_map.h hfs_misc.h
<span class="enscript-keyword">file_media.h:</span>	media.h
<span class="enscript-keyword">partition_map.h:</span>	dpme.h media.h
<span class="enscript-keyword">pathname.h:</span>	media.h
<span class="enscript-keyword">validate.h:</span>	partition_map.h

<span class="enscript-keyword">bitfield.o:</span>	bitfield.c bitfield.h
<span class="enscript-keyword">convert.o:</span>	convert.c convert.h
<span class="enscript-keyword">deblock_media.o:</span>	deblock_media.c deblock_media.h
<span class="enscript-keyword">dump.o:</span>		dump.c dump.h pathname.h io.h errors.h
<span class="enscript-keyword">errors.o:</span>	errors.c errors.h
<span class="enscript-keyword">file_media.o:</span>	file_media.c file_media.h errors.h
<span class="enscript-keyword">io.o:</span>		io.c io.h errors.h
<span class="enscript-keyword">layout_dump.o:</span>	layout_dump.c layout_dump.h
<span class="enscript-keyword">media.o:</span>	media.c media.h
<span class="enscript-keyword">partition_map.o:</span>	partition_map.c partition_map.h pathname.h deblock_media.h io.h convert.h util.h errors.h
<span class="enscript-keyword">pathname.o:</span>	pathname.c pathname.h file_media.h
<span class="enscript-keyword">pdisk.o:</span>	pdisk.c pdisk.h io.h partition_map.h pathname.h errors.h dump.h validate.h version.h util.h
<span class="enscript-keyword">util.o:</span>		util.c version.h util.h
<span class="enscript-keyword">validate.o:</span>	validate.c validate.h deblock_media.h pathname.h convert.h io.h errors.h


<span class="enscript-comment">#
</span><span class="enscript-comment"># fake dependencies used only by list.src {for $(MAC_PROJECT)}
</span><span class="enscript-comment">#
</span><span class="enscript-keyword">pdisk.mac__Data/CW__Settings.stm.bin:</span>
<span class="enscript-keyword">pdisk.mac__Data/pdisk.tdm.bin:</span>
<span class="enscript-keyword">pdisk.mac__Data/pdisk__68k.tdm.bin:</span>
</pre>
<hr />
</body></html>